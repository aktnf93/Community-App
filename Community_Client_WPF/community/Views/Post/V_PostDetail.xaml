<Window x:Class="community.Views.V_PostDetail"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:community.Views"
        xmlns:vm="clr-namespace:community.ViewModels"
        mc:Ignorable="d"
        WindowStartupLocation="CenterScreen"
        Title="게시글" Height="800" Width="1000"
        Loaded="{local:MethodBinding Loaded}">
    <Window.DataContext>
        <vm:VM_PostDetail/>
    </Window.DataContext>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="30"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0">
            <Grid Margin="10,0,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="60"/>
                    <ColumnDefinition Width="40"/>
                    <ColumnDefinition Width="60"/>
                    <ColumnDefinition Width="140"/>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="160"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="30"/>
                    <RowDefinition Height="40"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Column="0" Grid.Row="0" Text="게시글 ID: " HorizontalAlignment="Left" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding PostEdit.Id}" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                
                <TextBlock Grid.Column="2" Grid.Row="0" Text="카테고리: " HorizontalAlignment="Center" VerticalAlignment="Center"/>
                <ComboBox  Grid.Column="3" Grid.Row="0" Height="26"
                           ItemsSource="{Binding CategoryList}"
                           SelectedValue="{Binding PostEdit.Post_Category_Id, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                           SelectedValuePath="Id">

                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock x:Name="Txt" Text="{Binding Name, StringFormat={}• {0}}"/>
                            <DataTemplate.Triggers>
                                <DataTrigger Binding="{Binding Parent_Id}" Value="0">
                                    <Setter TargetName="Txt" Property="Text" Value="{Binding Name}"/>
                                </DataTrigger>
                            </DataTemplate.Triggers>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>

                <TextBlock Grid.Column="4" Grid.Row="0" Text="공지유무: " HorizontalAlignment="Center" VerticalAlignment="Center"/>
                <ComboBox  Grid.Column="5" Grid.Row="0" Height="26"
                           ItemsSource="{Binding PostLevelList}"
                           SelectedValue="{Binding PostEdit.Post_Level, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                           DisplayMemberPath="Key" SelectedValuePath="Value"/>

                <TextBlock Grid.Column="0" Grid.Row="1" Text="제목: " HorizontalAlignment="Left" VerticalAlignment="Center"/>
                <TextBox   Grid.Column="1" Grid.Row="1" Grid.ColumnSpan="6" Height="26" VerticalContentAlignment="Center" 
                           Text="{Binding PostEdit.Title}" Style="{x:Null}"/>
            </Grid>
        </Border>

        <Border Grid.Row="1" BorderBrush="Gray" BorderThickness="0,1,0,0">
            <Grid Margin="10,6,10,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" Tag="작성자"/>
                    <ColumnDefinition Width="Auto" Tag="댓글"/>
                    <ColumnDefinition Width="Auto" Tag="조회수"/>
                    <ColumnDefinition Width="Auto" Tag="작성일"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0">
                    <Run Text="작성자: "/>
                    <Run Text="{Binding PostEdit.Employee_Name}"/>
                </TextBlock>

                <TextBlock Grid.Column="1" HorizontalAlignment="Center">
                    <Run Text=" | 댓글: "/>
                    <Run Text="{Binding PostEdit.Comment_Count}"/>
                    <Run Text=" 건 "/>
                </TextBlock>

                <TextBlock Grid.Column="2" HorizontalAlignment="Center">
                    <Run Text=" | 조회수: "/>
                    <Run Text="{Binding PostEdit.View_Count}"/>
                    <Run Text=" 건 "/>
                </TextBlock>

                <TextBlock Grid.Column="3" HorizontalAlignment="Center">
                    <Run Text=" | 작성일: "/>
                    <Run Text="{Binding PostEdit.Created_At, StringFormat={}{0:yyyy-MM-dd HH:mm}}"/>
                </TextBlock>
            </Grid>
        </Border>

        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="330"/>
            </Grid.ColumnDefinitions>

            <!-- 본문 -->

            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="50"/>
                </Grid.RowDefinitions>

                <TextBox Grid.Row="0" Text="{Binding PostEdit.Content}" TextWrapping="Wrap" AcceptsReturn="True" Margin="10" Style="{x:Null}"/>
                <Button  Grid.Row="1" Content="게시글 저장" Width="100" Height="30" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="10" Click="{local:MethodBinding BtnPostSave}"/>
            </Grid>

            <!-- 댓글 -->

            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="100"/>
                    <RowDefinition Height="50"/>
                </Grid.RowDefinitions>

                <ItemsControl Grid.Row="0" ItemsSource="{Binding PostEdit.CommentList}" BorderBrush="Gray" BorderThickness="0.5">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel Orientation="Vertical"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.Template>
                        <ControlTemplate TargetType="{x:Type ItemsControl}">
                            <ScrollViewer VerticalScrollBarVisibility="Hidden">
                                <ItemsPresenter/>
                            </ScrollViewer>
                        </ControlTemplate>
                    </ItemsControl.Template>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Margin="5" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="110"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="30"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <Border Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="0" Background="LightBlue"/>
                                    <TextBlock Grid.Column="0" Grid.Row="0" Text="{Binding Employee_Name}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,0,0,0" />
                                    <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding Created_At, StringFormat={}{0:yyyy-MM-dd HH:mm}}" Foreground="Gray" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <TextBlock Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="1" Text="{Binding Content}" TextWrapping="Wrap" Margin="10"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

                <TextBox Grid.Row="1" Text="{Binding CommentEdit.Content}" TextWrapping="Wrap" AcceptsReturn="True" Margin="10" Style="{x:Null}"/>
                <Button  Grid.Row="2" Content="댓글 쓰기" Width="100" Height="30" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="10" Click="{local:MethodBinding BtnCommentSave}"/>
            </Grid>
        </Grid>
        
    </Grid>
</Window>
