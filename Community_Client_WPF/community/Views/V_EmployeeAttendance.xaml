<UserControl x:Class="community.Views.V_EmployeeAttendance"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:community.Views"
             xmlns:vm="clr-namespace:community.ViewModels"
             xmlns:u="clr-namespace:community.View_Controls"
             mc:Ignorable="d" 
             Width="1810" Height="950"
             Background="{StaticResource Color_WhiteGray}"
             >
    <Grid Loaded="{local:MethodBinding Loaded}">
        <Grid.DataContext>
            <vm:VM_EmployeeAttendance/>
        </Grid.DataContext>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="30"  Tag="여백"/>
            <ColumnDefinition Width="280" Tag="그룹"/>
            <ColumnDefinition Width="30"  Tag="여백"/>
            <ColumnDefinition Width="*"   Tag="리스트"/>
            <ColumnDefinition Width="30"  Tag="여백"/>
            <ColumnDefinition Width="440" Tag="디테일"/>
            <ColumnDefinition Width="30"  Tag="여백"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="60"  Tag="타이틀"/>
            <RowDefinition Height="10"  Tag="여백"/>
            <RowDefinition Height="100" Tag="컨트롤"/>
            <RowDefinition Height="50"  Tag="여백"/>
            <RowDefinition Height="*"   Tag="리스트"/>
            <RowDefinition Height="30"  Tag="여백"/>
        </Grid.RowDefinitions>

        <!-- 타이틀 -->
        <Grid Grid.Column="1" Grid.ColumnSpan="5" Grid.Row="0" TextBlock.FontFamily="고도 M">
            <TextBlock Text="직원 근태 관리" FontSize="24" FontWeight="Bold" HorizontalAlignment="Left" VerticalAlignment="Bottom"/>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="280,0,0,0" TextBlock.FontFamily="고도 M" TextBlock.FontWeight="Bold" TextBlock.FontSize="18">
                <Label Content="〈" Width="20" Cursor="Hand" HorizontalContentAlignment="Center" Foreground="{StaticResource Color_Gray}"  MouseLeftButtonDown="{local:MethodBinding BtnToDayDown}"/>
                <Label Content="{Binding AttendanceToDay, TargetNullValue=0000-00-00}" ContentStringFormat="yyyy-MM-dd" Foreground="#2189EA"/>
                <Label Content="출퇴근 내역"/>
                <Label Content="〉" Width="20" Cursor="Hand" HorizontalContentAlignment="Center" Foreground="{StaticResource Color_Gray}" MouseLeftButtonDown="{local:MethodBinding BtnToDayUp}"/>
            </StackPanel>
        </Grid>

        <!-- 중간 컨트롤 (검색) -->
        <Border Grid.Column="1" Grid.ColumnSpan="1" Grid.Row="2" Style="{StaticResource BaseCard}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                    <TextBlock Text="검색옵션" FontSize="13" FontWeight="Bold" Width="50" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    <CheckBox Content="출근" IsChecked="True" Margin="20,0,0,0"/>
                    <CheckBox Content="결근"/>
                </StackPanel>

                <Line Grid.Row="0" Stroke="{StaticResource Color_Gray}" StrokeThickness="0.5" X1="0" X2="2000"
                      HorizontalAlignment="Stretch" VerticalAlignment="Bottom"/>

                <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                    <TextBlock Text="검색명" FontSize="13" FontWeight="Bold" Width="50" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="10,0,0,0"/>

                    <TextBox Width="110" Height="28" ToolTip="직원명" Margin="20,0,0,0"/>

                    <Button Width="70" Height="28" Content="검색" ToolTip="검색" Margin="6,0,0,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- 그룹 리스트 -->
        <Border Grid.Column="1" Grid.Row="4" Style="{StaticResource BaseCard}">
            <TreeView ItemsSource="{Binding TeamTreeList}" Style="{StaticResource Tree_EmployeesGroup}" Margin="4"/>
        </Border>

        <!-- 멤버 수 (카드) -->
        <Grid Grid.Column="3" Grid.ColumnSpan="3" Grid.Row="2" TextBlock.FontFamily="고도 M">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"  Tag="전체"/>
                <ColumnDefinition Width="20" Tag="여백"/>
                <ColumnDefinition Width="*"  Tag="출근"/>
                <ColumnDefinition Width="20" Tag="여백"/>
                <ColumnDefinition Width="*"  Tag="결근"/>
                <ColumnDefinition Width="20" Tag="여백"/>
                <ColumnDefinition Width="*"  Tag="수정"/>
            </Grid.ColumnDefinitions>
            <Grid.Resources>
                <ControlTemplate TargetType="{x:Type Control}" x:Key="Card_EmployeeAttendance">
                    <Grid>
                        <Border Background="{TemplateBinding Background}" CornerRadius="8">
                            <Border.Effect>
                                <DropShadowEffect Color="Black" BlurRadius="10" ShadowDepth="5" Direction="320" Opacity="0.5"/>
                            </Border.Effect>
                        </Border>
                        <Image Source="{TemplateBinding Tag}" Width="50" Height="50" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="30,0,0,0"/>
                        <TextBlock HorizontalAlignment="Left" VerticalAlignment="Top" Margin="100,30,0,0">
                            <Run Text="{TemplateBinding Name}" FontSize="18" Foreground="{StaticResource Color_Black}"/>
                            <LineBreak/>
                            <Run Text="{TemplateBinding Uid}" FontSize="20" Foreground="{TemplateBinding Foreground}" FontWeight="Bold"/>
                            <Run Text="건" FontSize="15" Foreground="{StaticResource Color_Black}"/>
                        </TextBlock>
                    </Grid>
                </ControlTemplate>
            </Grid.Resources>
            
            <ContentControl Grid.Column="0" Grid.Row="1" Template="{StaticResource Card_EmployeeAttendance}" Name="전체내역" Background="#CFE0E5" Foreground="#89C148" Uid="{Binding Cards[0].Content}" Tag="{StaticResource Img_TotalListg}"/>
            <ContentControl Grid.Column="2" Grid.Row="1" Template="{StaticResource Card_EmployeeAttendance}" Name="정상근무" Background="#FFFFFF" Foreground="#3498DB" Uid="{Binding Cards[1].Content}" Tag="{StaticResource Img_InList}"    />
            <ContentControl Grid.Column="4" Grid.Row="1" Template="{StaticResource Card_EmployeeAttendance}" Name="근태이상" Background="#FFFFFF" Foreground="#E74C3C" Uid="{Binding Cards[2].Content}" Tag="{StaticResource Img_OutList}"/>
            <ContentControl Grid.Column="6" Grid.Row="1" Template="{StaticResource Card_EmployeeAttendance}" Name="연차사용" Background="#FFFFFF" Foreground="#F7B000" Uid="{Binding Cards[3].Content}" Tag="{StaticResource Img_StarList}"/>
        </Grid>

        <StackPanel Grid.Column="3" Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Bottom" Margin="10,0,0,4"
                    TextBlock.FontSize="13">
            <TextBlock Text="[회사] SH ELECTRONIC  >  [부서] 경영지원본부  >  [팀] 총무팀"/>
            <TextBlock Text="6" Margin="6,0,6,0"/>
            <TextBlock Text="명"/>
        </StackPanel>
        
        <!-- 멤버 리스트 -->
        <ItemsControl Grid.Column="3" Grid.ColumnSpan="3" Grid.Row="4" ItemsSource="{Binding AttendanceList}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <VirtualizingStackPanel Orientation="Vertical"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.Template>
                <ControlTemplate TargetType="{x:Type ItemsControl}">
                    <Border Style="{StaticResource BaseCard}">
                        <Grid>
                            <Grid.Resources>
                                <Style TargetType="{x:Type TextBlock}">
                                    <Setter Property="HorizontalAlignment" Value="Center"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                    <Setter Property="FontSize" Value="14"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                </Style>
                            </Grid.Resources>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="140"  Tag="일자"/>
                                <ColumnDefinition Width="90"  Tag="사원번호"/>
                                <ColumnDefinition Width="120" Tag="이름"/>
                                <ColumnDefinition Width="100" Tag="부서"/>
                                <ColumnDefinition Width="100" Tag="직급"/>
                                <ColumnDefinition Width="100" Tag="근로자 유형"/>
                                <ColumnDefinition Width="140"  Tag="근무 시작"/>
                                <ColumnDefinition Width="140"  Tag="근무 종료"/>
                                <ColumnDefinition Width="180" Tag="인정 근무시간"/>
                                <ColumnDefinition Width="*"   Tag="비고"/>
                                <ColumnDefinition Width="140"  Tag="상태"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="40"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0" Grid.ColumnSpan="20" Background="{StaticResource Color_LightGray}" CornerRadius="8,8,0,0"/>
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="일자"/>
                            <TextBlock Grid.Column="1" Grid.Row="0" Text="사원번호"/>
                            <TextBlock Grid.Column="2" Grid.Row="0" Text="이름"/>
                            <TextBlock Grid.Column="3" Grid.Row="0" Text="부서"/>
                            <TextBlock Grid.Column="4" Grid.Row="0" Text="직급"/>
                            <TextBlock Grid.Column="5" Grid.Row="0" Text="근로자 유형"/>
                            <TextBlock Grid.Column="6" Grid.Row="0" Text="근무 시작"/>
                            <TextBlock Grid.Column="7" Grid.Row="0" Text="근무 종료"/>
                            <TextBlock Grid.Column="8" Grid.Row="0" Text="인정 근무 시간"/>
                            <TextBlock Grid.Column="9" Grid.Row="0" Text="비고"/>
                            <TextBlock Grid.Column="10" Grid.Row="0" Text="상태"/>

                            <Line Grid.Column="0" Grid.ColumnSpan="20" Grid.Row="0" Stroke="{StaticResource Color_Gray2}" StrokeThickness="1" X1="0" X2="2000" HorizontalAlignment="Stretch" VerticalAlignment="Bottom"/>

                            <Line Grid.Column="0" Grid.Row="0" Grid.RowSpan="2" Stroke="{StaticResource Color_Gray2}" StrokeThickness="1" X1="0" Y2="2000" HorizontalAlignment="Right" VerticalAlignment="Stretch"/>
                            <Line Grid.Column="1" Grid.Row="0" Grid.RowSpan="2" Stroke="{StaticResource Color_Gray2}" StrokeThickness="1" X1="0" Y2="2000" HorizontalAlignment="Right" VerticalAlignment="Stretch"/>
                            <Line Grid.Column="2" Grid.Row="0" Grid.RowSpan="2" Stroke="{StaticResource Color_Gray2}" StrokeThickness="1" X1="0" Y2="2000" HorizontalAlignment="Right" VerticalAlignment="Stretch"/>
                            <Line Grid.Column="3" Grid.Row="0" Grid.RowSpan="2" Stroke="{StaticResource Color_Gray2}" StrokeThickness="1" X1="0" Y2="2000" HorizontalAlignment="Right" VerticalAlignment="Stretch"/>
                            <Line Grid.Column="4" Grid.Row="0" Grid.RowSpan="2" Stroke="{StaticResource Color_Gray2}" StrokeThickness="1" X1="0" Y2="2000" HorizontalAlignment="Right" VerticalAlignment="Stretch"/>
                            <Line Grid.Column="5" Grid.Row="0" Grid.RowSpan="2" Stroke="{StaticResource Color_Gray2}" StrokeThickness="1" X1="0" Y2="2000" HorizontalAlignment="Right" VerticalAlignment="Stretch"/>
                            <Line Grid.Column="6" Grid.Row="0" Grid.RowSpan="2" Stroke="{StaticResource Color_Gray2}" StrokeThickness="1" X1="0" Y2="2000" HorizontalAlignment="Right" VerticalAlignment="Stretch"/>
                            <Line Grid.Column="7" Grid.Row="0" Grid.RowSpan="2" Stroke="{StaticResource Color_Gray2}" StrokeThickness="1" X1="0" Y2="2000" HorizontalAlignment="Right" VerticalAlignment="Stretch"/>
                            <Line Grid.Column="8" Grid.Row="0" Grid.RowSpan="2" Stroke="{StaticResource Color_Gray2}" StrokeThickness="1" X1="0" Y2="2000" HorizontalAlignment="Right" VerticalAlignment="Stretch"/>
                            <Line Grid.Column="9" Grid.Row="0" Grid.RowSpan="2" Stroke="{StaticResource Color_Gray2}" StrokeThickness="1" X1="0" Y2="2000" HorizontalAlignment="Right" VerticalAlignment="Stretch"/>
                            <ScrollViewer Grid.Column="0" Grid.ColumnSpan="20" Grid.Row="1" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Hidden" Margin="0,0,0,20">
                                <ItemsPresenter/>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </ItemsControl.Template>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border x:Name="Bor" Height="40"  Margin="0,0,0,0" Background="Transparent"
                            BorderBrush="Transparent" BorderThickness="0.5" CornerRadius="4" MouseLeftButtonDown="{local:MethodBinding OnSelect}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="140"  Tag="일자"/>
                                <ColumnDefinition Width="90"  Tag="사원번호"/>
                                <ColumnDefinition Width="120" Tag="이름"/>
                                <ColumnDefinition Width="100" Tag="부서"/>
                                <ColumnDefinition Width="100" Tag="직급"/>
                                <ColumnDefinition Width="100" Tag="근로자 유형"/>
                                <ColumnDefinition Width="140"  Tag="근무 시작"/>
                                <ColumnDefinition Width="140"  Tag="근무 종료"/>
                                <ColumnDefinition Width="180" Tag="인정 근무 시간"/>
                                <ColumnDefinition Width="*"   Tag="비고"/>
                                <ColumnDefinition Width="140"  Tag="상태"/>
                            </Grid.ColumnDefinitions>
                            <Grid.Resources>
                                <Style TargetType="{x:Type TextBlock}">
                                    <Setter Property="HorizontalAlignment" Value="Center"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                    <Setter Property="FontSize" Value="13"/>
                                </Style>
                            </Grid.Resources>

                            <TextBlock Grid.Column="0">
                                <Run Text="{Binding SelectedDate, StringFormat={}{0:MM월 dd일 dddd}}" Language="ko-KR"/>
                            </TextBlock>

                            <TextBlock Grid.Column="1">
                                <Run Text="{Binding Employee_Id}"/>
                                <Run Text="-"/>
                                <Run Text="{Binding Employee_Code}"/>
                            </TextBlock>

                            <TextBlock Grid.Column="2">
                                <Run Text="{Binding Name}"/>
                            </TextBlock>

                            <TextBlock Grid.Column="3">
                                <Run Text="{Binding Department_Name}"/>
                            </TextBlock>

                            <TextBlock Grid.Column="4">
                                <Run Text="{Binding Rank_Name}"/>
                            </TextBlock>

                            <TextBlock Grid.Column="5">
                                <Run Text="정규직"/>
                            </TextBlock>

                            <TextBlock Grid.Column="6">
                                <Run Text="{Binding Start_Work_At, StringFormat={}{0:tt HH시 mm분}, TargetNullValue=-}" Language="ko-KR"/>
                            </TextBlock>

                            <TextBlock Grid.Column="7">
                                <Run Text="{Binding End_Work_At, StringFormat={}{0:tt HH시 mm분}, TargetNullValue=-}" Language="ko-KR"/>
                            </TextBlock>

                            <TextBlock Grid.Column="8">
                                <Run Text="{Binding Total_Work_Minutes, StringFormat={}{0:HH시간 mm분}, TargetNullValue=-}"/>
                            </TextBlock>

                            <TextBlock Grid.Column="9" Text="{Binding Description}" HorizontalAlignment="Left" Margin="10,0,0,0"/>

                            <ContentControl Grid.Column="10" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <ContentControl.Template>
                                    <ControlTemplate TargetType="{x:Type ContentControl}">
                                        <Border x:Name="Bor" BorderThickness="2" CornerRadius="14" Width="80" Height="28">
                                            <TextBlock x:Name="Txt" Text="{Binding Status}" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                       Foreground="White"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <DataTrigger Binding="{Binding Status}" Value="정상근무">
                                                <Setter TargetName="Bor" Property="Background" Value="#1962C3"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="근태이상">
                                                <Setter TargetName="Bor" Property="Background" Value="#E74C3C"/>
                                            </DataTrigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </ContentControl.Template>
                            </ContentControl>

                            <Line Grid.Column="0" Grid.ColumnSpan="20" Grid.Row="0" Stroke="{StaticResource Color_Gray2}" StrokeThickness="1" X1="0" X2="2000" HorizontalAlignment="Stretch" VerticalAlignment="Bottom"/>
                        </Grid>
                    </Border>
                    <DataTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Bor" Property="BorderBrush" Value="Blue"/>
                        </Trigger>
                    </DataTemplate.Triggers>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </Grid>
</UserControl>
